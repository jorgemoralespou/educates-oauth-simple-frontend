import Link from "next/link";
import Image from "next/image";
import { UserMenu } from "./UserMenu";

interface HeaderProps {
  userName?: string;
  homeHref?: string;
  siteTitle?: string;
  logoUrl?: string | null;
}

function DefaultLogo() {
  return (
    <svg
      width="32"
      height="32"
      viewBox="-1 -33 656 636"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g stroke="none" fill="none" fillOpacity="1">
        <g>
          <path d="M 324.71042 -32.480515 C 318.93098 -32.189375 313.26835 -30.756423 308.05473 -28.265724 L 80.77575 80.33054 C 68.859514 86.02139 60.20436 96.78417 57.26013 109.57247 L 1.1888527 353.5071 C -1.4270029 364.86196 .7014656 376.78344 7.089582 386.5569 C 7.856256 387.7395 8.680806 388.88418 9.560275 389.98684 L 166.8737 585.5822 C 175.12234 595.8347 187.62883 601.80445 200.85365 601.8019 L 453.1307 601.7436 C 466.3506 601.75325 478.8562 595.7946 487.11065 585.553 L 644.366 389.9289 C 652.619 379.67123 655.7112 366.24336 652.7665 353.44913 L 596.60806 109.51434 C 593.6638 96.72603 585.0087 85.96325 573.0924 80.27241 L 345.7844 -28.265724 C 339.22645 -31.39883 331.9801 -32.848095 324.71042 -32.480515 Z" fill="#326ce5"/>
          <path d="M 324.709 -32.724848 C 318.9318 -32.422232 313.2735 -30.979553 308.0654 -28.48127 L 80.59343 80.17069 C 68.66853 85.86611 60.007195 96.637 57.0609 109.4348 L .9575832 353.5504 C -1.668212 364.9189 .45905185 376.8575 6.854466 386.64474 C 7.6245305 387.82303 8.452141 388.96333 9.334341 390.06157 L 166.75982 585.81695 C 175.01462 596.076 187.52965 602.0496 200.76349 602.04724 L 453.22845 601.992 C 466.4576 602.00105 478.9718 596.038 487.23215 585.78926 L 644.6025 390.0063 C 652.8536 379.7462 655.9468 366.3187 653.007 353.52265 L 596.8211 109.37969 C 593.8672 96.59222 585.20694 85.83276 573.2886 80.14313 L 345.81666 -28.508828 C 339.24823 -31.64651 331.98995 -33.09627 324.709 -32.724848 Z M 324.8191 -15.971003 C 331.71066 -16.319464 338.5801 -14.945577 344.79694 -11.975433 L 560.2822 90.9174 C 571.5787 96.31222 579.78374 106.51521 582.5749 118.6384 L 635.8124 349.8855 C 638.6039 362.01425 635.6726 374.7437 627.8488 384.4678 L 478.7727 569.9174 C 470.9476 579.6264 459.0924 585.2751 446.56013 585.2659 L 207.40455 585.32115 C 194.8676 585.3236 183.0116 579.6644 175.19198 569.9452 L 26.060762 384.5232 C 25.227036 383.4779 24.445373 382.39274 23.718576 381.27167 C 17.662731 372.00653 15.644983 360.7051 18.124793 349.94086 L 71.27965 118.69376 C 74.07074 106.5706 82.27572 96.36762 93.57216 90.97277 L 309.02987 -11.975175 C 313.97232 -14.336329 319.34042 -15.69475 324.81927 -15.970746 Z" fill="white" stroke="#326ce5" strokeLinecap="butt" strokeLinejoin="round" strokeWidth=".25"/>
        </g>
        <g>
          <path d="M 185.83954 281.83074 L 185.83954 333.83486 C 185.83954 376.92515 221.12385 420.01544 326.9768 420.01544 C 432.82974 420.01544 468.11405 376.92515 468.11405 333.83486 L 468.11405 281.83074 L 329.3042 326.164 C 327.7902 326.64753 326.1634 326.64753 324.6494 326.164 Z" fill="white" stroke="gray" strokeLinecap="round" strokeLinejoin="round" strokeWidth="1"/>
          <path d="M 329.41072 150.02735 L 547.1158 219.55824 C 551.3246 220.90246 553.6468 225.4041 552.3026 229.61293 C 551.5149 232.07935 549.5822 234.01203 547.1158 234.79976 L 329.41072 304.33065 C 327.8275 304.8363 326.1261 304.8363 324.54287 304.33065 L 106.83782 234.79976 C 102.62899 233.45554 100.30676 228.9539 101.65099 224.74507 C 102.43871 222.27865 104.3714 220.34597 106.83782 219.55824 L 324.54287 150.02735 C 326.1261 149.5217 327.8275 149.5217 329.41072 150.02735 Z" fill="white" stroke="gray" strokeLinecap="round" strokeLinejoin="round" strokeWidth=".908589"/>
          <ellipse cx="140.38856" cy="300.3202" rx="23.9216068517708" ry="23.9390882338745" fill="white" stroke="gray" strokeLinecap="round" strokeLinejoin="round" strokeWidth="1"/>
          <path d="M 121.51024 416.7764 L 137.3981 218.033 C 137.53013 216.38142 138.97604 215.14958 140.62762 215.2816 C 142.09582 215.39898 143.26165 216.5648 143.37902 218.033 L 159.26688 416.7764 C 159.39891 418.42796 158.16707 419.87387 156.51548 420.0059 C 156.43595 420.01226 156.3562 420.01544 156.27642 420.01544 L 124.5007 420.01544 C 122.84385 420.01544 121.5007 418.6723 121.5007 417.01544 C 121.5007 416.93566 121.50388 416.8559 121.51024 416.7764 Z" fill="white"/>
        </g>
      </g>
    </svg>
  );
}

export function Header({ userName, homeHref = "/portal", siteTitle = "Educates Training Platform", logoUrl }: HeaderProps) {
  return (
    <header className="px-6 py-3 flex items-center justify-between" style={{ backgroundColor: 'var(--header-bg)', color: 'var(--header-text)' }}>
      <div className="flex items-center gap-6">
        <Link href={homeHref} className="flex items-center gap-3">
          {logoUrl ? (
            <Image src={logoUrl} alt="Logo" width={32} height={32} unoptimized />
          ) : (
            <DefaultLogo />
          )}
        </Link>
        <nav>
          <Link href={homeHref} className="text-sm font-medium transition-colors header-link">
            {siteTitle}
          </Link>
        </nav>
      </div>
      {userName && <UserMenu name={userName} />}
    </header>
  );
}
